<!-- Enhanced Payment Method Page -->
<style>
  @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap');

  :root {
    --brand:          #00C896;
    --brand-dark:     #00A87D;
    --brand-light:    #E6FBF5;
    --brand-glow:     rgba(0, 200, 150, 0.20);
    --surface:        #FFFFFF;
    --surface-2:      #F7FAFA;
    --border:         #E8F0EE;
    --border-focus:   #00C896;
    --text-primary:   #0D2622;
    --text-secondary: #5A7A75;
    --text-muted:     #9BB5B0;
    --blue:           #3B82F6;
    --blue-light:     #EFF6FF;
    --green:          #22C55E;
    --green-light:    #F0FDF4;
    --purple:         #8B5CF6;
    --purple-light:   #F5F3FF;
    --amber:          #F59E0B;
    --amber-light:    #FFFBEB;
    --indigo:         #6366F1;
    --indigo-light:   #EEF2FF;
    --orange:         #F97316;
    --orange-light:   #FFF7ED;
    --shadow-sm:      0 2px 8px rgba(0, 40, 30, 0.06);
    --radius-xl:      24px;
    --radius-lg:      16px;
    --radius-md:      12px;
  }

  * { box-sizing: border-box; margin: 0; padding: 0; }

  .app-shell {
    font-family: 'Plus Jakarta Sans', sans-serif;
    background: var(--surface-2);
    min-height: 100vh;
    padding-bottom: 40px;
    color: var(--text-primary);
    -webkit-font-smoothing: antialiased;
  }

  /* ── Sticky top bar ── */
  .app-topbar {
    position: sticky;
    top: 0;
    z-index: 100;
    background: rgba(255,255,255,0.92);
    backdrop-filter: blur(16px);
    -webkit-backdrop-filter: blur(16px);
    border-bottom: 1px solid var(--border);
    padding: 18px 20px 14px;
    display: flex;
    align-items: center;
    gap: 12px;
  }

  .topbar-icon {
    width: 40px;
    height: 40px;
    background: linear-gradient(135deg, var(--brand), var(--brand-dark));
    border-radius: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    box-shadow: 0 4px 12px var(--brand-glow);
  }

  .topbar-icon svg { width: 20px; height: 20px; stroke: #fff; }
  .topbar-title    { font-size: 18px; font-weight: 800; color: var(--text-primary); letter-spacing: -0.3px; }
  .topbar-sub      { font-size: 12px; font-weight: 500; color: var(--text-muted); margin-top: 1px; }

  /* ── Messages ── */
  .messages-wrap { padding: 16px 16px 0; display: flex; flex-direction: column; gap: 8px; }

  .msg-toast {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 12px 16px;
    border-radius: var(--radius-md);
    font-size: 13px;
    font-weight: 600;
  }

  .msg-toast.success { background: #E6FBF5; color: #006B50; border: 1px solid #9FECDA; }
  .msg-toast.error   { background: #FFF0F0; color: #CC3333; border: 1px solid #FFBFBF; }
  .msg-toast.info    { background: #EFF6FF; color: #1D4ED8; border: 1px solid #BFDBFE; }
  .msg-toast svg     { width: 16px; height: 16px; stroke: currentColor; flex-shrink: 0; }

  /* ── Section header ── */
  .section-header {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 24px 20px 12px;
  }

  .section-dot   { width: 8px; height: 8px; border-radius: 50%; background: var(--brand); flex-shrink: 0; }
  .section-title { font-size: 15px; font-weight: 800; color: var(--text-primary); letter-spacing: -0.2px; }

  /* ── Payment options list ── */
  .payment-list {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: var(--radius-xl);
    margin: 0 16px;
    overflow: hidden;
    box-shadow: var(--shadow-sm);
  }

  /* ── Individual payment option ── */
  .payment-option { position: relative; }

  .payment-option + .payment-option { border-top: 1px solid var(--border); }

  /* Hide native radio */
  .payment-option input[type="radio"] {
    position: absolute;
    opacity: 0;
    width: 0;
    height: 0;
    pointer-events: none;
  }

  .payment-label {
    display: flex;
    align-items: center;
    gap: 14px;
    padding: 16px 18px;
    cursor: pointer;
    background: var(--surface);
    transition: background 0.15s ease;
    position: relative;
    -webkit-tap-highlight-color: transparent;
  }

  /* Selected state */
  .payment-option input[type="radio"]:checked + .payment-label {
    background: var(--brand-light);
  }

  /* Left accent bar on selection */
  .payment-option input[type="radio"]:checked + .payment-label::before {
    content: '';
    position: absolute;
    left: 0;
    top: 0;
    bottom: 0;
    width: 4px;
    background: var(--brand);
    border-radius: 4px 0 0 4px;
  }

  /* ── Payment icon ── */
  .pay-icon {
    width: 42px;
    height: 42px;
    border-radius: 13px;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
  }

  .pay-icon svg { width: 20px; height: 20px; }

  .pay-icon.blue   { background: var(--blue-light);   } .pay-icon.blue   svg { stroke: var(--blue);   }
  .pay-icon.green  { background: var(--green-light);  } .pay-icon.green  svg { stroke: var(--green);  }
  .pay-icon.purple { background: var(--purple-light); } .pay-icon.purple svg { stroke: var(--purple); }
  .pay-icon.amber  { background: var(--amber-light);  } .pay-icon.amber  svg { stroke: var(--amber);  }
  .pay-icon.indigo { background: var(--indigo-light); } .pay-icon.indigo svg { stroke: var(--indigo); }
  .pay-icon.orange { background: var(--orange-light); } .pay-icon.orange svg { stroke: var(--orange); }
  .pay-icon.gray   { background: var(--surface-2);    } .pay-icon.gray   svg { stroke: var(--text-muted); }

  /* ── Payment text ── */
  .pay-text  { flex: 1; min-width: 0; }
  .pay-title { font-size: 14px; font-weight: 700; color: var(--text-primary); margin-bottom: 2px; letter-spacing: -0.1px; }
  .pay-desc  { font-size: 12px; font-weight: 500; color: var(--text-muted); line-height: 1.35; }

  /* ── Check indicator ── */
  .pay-check {
    width: 22px;
    height: 22px;
    border-radius: 50%;
    border: 2px solid var(--border);
    flex-shrink: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: background 0.15s ease, border-color 0.15s ease;
  }

  .pay-check svg { width: 11px; height: 11px; stroke: transparent; stroke-width: 2.5; transition: stroke 0.15s ease; }

  .payment-option input[type="radio"]:checked + .payment-label .pay-check {
    background: var(--brand);
    border-color: var(--brand);
  }

  .payment-option input[type="radio"]:checked + .payment-label .pay-check svg {
    stroke: #fff;
  }

  /* ── CTA button ── */
  .cta-wrap { padding: 16px 16px 0; }

  .btn-primary {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    width: 100%;
    height: 52px;
    background: var(--brand);
    color: #fff;
    border: none;
    border-radius: var(--radius-lg);
    font-family: 'Plus Jakarta Sans', sans-serif;
    font-size: 15px;
    font-weight: 700;
    letter-spacing: -0.2px;
    cursor: pointer;
    box-shadow: 0 4px 16px var(--brand-glow);
    transition: background 0.15s ease, box-shadow 0.15s ease;
    -webkit-tap-highlight-color: transparent;
  }

  .btn-primary:hover  { background: var(--brand-dark); box-shadow: 0 6px 20px rgba(0,200,150,0.32); }
  .btn-primary:active { background: var(--brand-dark); box-shadow: none; }
  .btn-primary svg    { width: 18px; height: 18px; stroke: #fff; }

  /* ── Security note ── */
  .security-card {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: var(--radius-xl);
    margin: 12px 16px 0;
    padding: 16px 18px;
    display: flex;
    align-items: flex-start;
    gap: 12px;
    box-shadow: var(--shadow-sm);
  }

  .security-icon {
    width: 36px;
    height: 36px;
    background: var(--brand-light);
    border-radius: 10px;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
  }

  .security-icon svg { width: 17px; height: 17px; stroke: var(--brand-dark); }

  .security-title { font-size: 13px; font-weight: 700; color: var(--text-primary); margin-bottom: 3px; }
  .security-desc  { font-size: 12px; font-weight: 500; color: var(--text-muted); line-height: 1.5; }
</style>

<div class="app-shell">

  <!-- Top bar -->
  <div class="app-topbar">
    <div class="topbar-icon">
      <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z"/>
      </svg>
    </div>
    <div>
      <div class="topbar-title">Payment Preference</div>
      <div class="topbar-sub">Choose how you want to pay</div>
    </div>
  </div>

  <!-- Django messages -->
  {% if messages %}
    <div class="messages-wrap">
      {% for message in messages %}
        <div class="msg-toast {% if message.tags == 'success' %}success{% elif message.tags == 'error' %}error{% else %}info{% endif %}">
          {% if message.tags == 'success' %}
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
            </svg>
          {% elif message.tags == 'error' %}
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01"/>
            </svg>
          {% else %}
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
            </svg>
          {% endif %}
          {{ message }}
        </div>
      {% endfor %}
    </div>
  {% endif %}

  <!-- Section header -->
  <div class="section-header">
    <div class="section-dot"></div>
    <div class="section-title">Select Payment Method</div>
  </div>

  <!-- Form -->
  <form id="payment-form" method="post" action="{% url 'update_payment_method' %}">
    {% csrf_token %}

    <div class="payment-list">
      {% for choice in form.payment_method %}
        <div class="payment-option">

          <!-- Radio input (hidden, native) -->
          {{ choice.tag }}

          <!-- Visible label row -->
          <label for="{{ choice.id_for_label }}" class="payment-label">

            <!-- Icon -->
            {% if choice.choice_label == "Credit Card" %}
              <div class="pay-icon blue">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"/>
                </svg>
              </div>
            {% elif choice.choice_label == "Debit Card" %}
              <div class="pay-icon green">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"/>
                </svg>
              </div>
            {% elif choice.choice_label == "Digital Wallet" %}
              <div class="pay-icon purple">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 18h.01M8 21h8a2 2 0 002-2V5a2 2 0 00-2-2H8a2 2 0 00-2 2v14a2 2 0 002 2z"/>
                </svg>
              </div>
            {% elif choice.choice_label == "Cash" %}
              <div class="pay-icon amber">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z"/>
                </svg>
              </div>
            {% elif choice.choice_label == "UPI" %}
              <div class="pay-icon indigo">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 18h.01M8 21h8a2 2 0 002-2V5a2 2 0 00-2-2H8a2 2 0 00-2 2v14a2 2 0 002 2z"/>
                </svg>
              </div>
            {% elif choice.choice_label == "Net Banking" %}
              <div class="pay-icon orange">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"/>
                </svg>
              </div>
            {% else %}
              <div class="pay-icon gray">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z"/>
                </svg>
              </div>
            {% endif %}

            <!-- Text -->
            <div class="pay-text">
              <div class="pay-title">{{ choice.choice_label }}</div>
              <div class="pay-desc">
                {% if choice.choice_label == "Credit Card" %}Secure payments with your credit card
                {% elif choice.choice_label == "Debit Card" %}Direct payment from your bank account
                {% elif choice.choice_label == "Digital Wallet" %}Quick payments with mobile wallet
                {% elif choice.choice_label == "Cash" %}Pay with cash after your ride
                {% elif choice.choice_label == "UPI" %}Instant payments with UPI
                {% elif choice.choice_label == "Net Banking" %}Secure online banking payments
                {% else %}{{ choice.choice_label }} payment method{% endif %}
              </div>
            </div>

            <!-- Check indicator -->
            <div class="pay-check">
              <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"/>
              </svg>
            </div>

          </label>
        </div>
      {% endfor %}
    </div>

    <!-- Save button -->
    <div class="cta-wrap">
      <button type="submit" class="btn-primary">
        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
        </svg>
        Save Payment Method
      </button>
    </div>

  </form>

  <!-- Security note -->
  <div class="security-card">
    <div class="security-icon">
      <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"/>
      </svg>
    </div>
    <div>
      <div class="security-title">Secure Payments</div>
      <div class="security-desc">Your payment information is encrypted and secure. You can change your preferred method anytime.</div>
    </div>
  </div>

</div><!-- /app-shell -->