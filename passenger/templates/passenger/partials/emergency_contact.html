<!-- Emergency Contact Page -->
<style>
  @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap');

  :root {
    --brand:          #00C896;
    --brand-dark:     #00A87D;
    --brand-light:    #E6FBF5;
    --brand-glow:     rgba(0, 200, 150, 0.20);
    --surface:        #FFFFFF;
    --surface-2:      #F7FAFA;
    --border:         #E8F0EE;
    --text-primary:   #0D2622;
    --text-secondary: #5A7A75;
    --text-muted:     #9BB5B0;
    --danger:         #FF5C5C;
    --danger-light:   #FFF0F0;
    --shadow-sm:      0 2px 8px rgba(0, 40, 30, 0.06);
    --radius-xl:      24px;
    --radius-lg:      16px;
    --radius-md:      12px;
  }

  * { box-sizing: border-box; margin: 0; padding: 0; }

  .app-shell {
    font-family: 'Plus Jakarta Sans', sans-serif;
    background: var(--surface-2);
    min-height: 100vh;
    padding-bottom: 40px;
    color: var(--text-primary);
    -webkit-font-smoothing: antialiased;
  }

  /* ── Sticky top bar ── */
  .app-topbar {
    position: sticky;
    top: 0;
    z-index: 100;
    background: rgba(255,255,255,0.92);
    backdrop-filter: blur(16px);
    -webkit-backdrop-filter: blur(16px);
    border-bottom: 1px solid var(--border);
    padding: 18px 20px 14px;
    display: flex;
    align-items: center;
    gap: 12px;
  }

  .topbar-icon {
    width: 40px;
    height: 40px;
    background: linear-gradient(135deg, var(--brand), var(--brand-dark));
    border-radius: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    box-shadow: 0 4px 12px var(--brand-glow);
  }

  .topbar-icon svg { width: 20px; height: 20px; stroke: #fff; }
  .topbar-title    { font-size: 18px; font-weight: 800; color: var(--text-primary); letter-spacing: -0.3px; }
  .topbar-sub      { font-size: 12px; font-weight: 500; color: var(--text-muted); margin-top: 1px; }

  /* ── Success message ── */
  .success-wrap { padding: 16px 16px 0; }

  .msg-toast {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 12px 16px;
    border-radius: var(--radius-md);
    font-size: 13px;
    font-weight: 600;
    background: #E6FBF5;
    color: #006B50;
    border: 1px solid #9FECDA;
  }

  .msg-toast svg { width: 16px; height: 16px; stroke: currentColor; flex-shrink: 0; }

  /* ── SOS hero accent ── */
  .sos-hero {
    margin: 20px 16px 0;
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: var(--radius-xl);
    padding: 24px 20px;
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
    box-shadow: var(--shadow-sm);
    gap: 10px;
  }

  .sos-circle {
    width: 64px;
    height: 64px;
    border-radius: 20px;
    background: #FFF0F0;
    border: 1.5px solid #FFBFBF;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .sos-circle svg { width: 28px; height: 28px; stroke: var(--danger); }

  .sos-title { font-size: 16px; font-weight: 800; color: var(--text-primary); letter-spacing: -0.2px; }
  .sos-desc  { font-size: 13px; font-weight: 500; color: var(--text-muted); line-height: 1.5; max-width: 260px; }

  /* ── Section header ── */
  .section-header {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 24px 20px 12px;
  }

  .section-dot   { width: 8px; height: 8px; border-radius: 50%; background: var(--brand); flex-shrink: 0; }
  .section-title { font-size: 15px; font-weight: 800; color: var(--text-primary); letter-spacing: -0.2px; }

  /* ── Form card ── */
  .form-card {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: var(--radius-xl);
    margin: 0 16px;
    overflow: hidden;
    box-shadow: var(--shadow-sm);
    padding: 18px;
  }

  /* ── Field ── */
  .field-label {
    display: flex;
    align-items: center;
    gap: 6px;
    font-size: 11px;
    font-weight: 700;
    color: var(--text-muted);
    text-transform: uppercase;
    letter-spacing: 0.5px;
    margin-bottom: 8px;
  }

  .field-label svg { width: 13px; height: 13px; stroke: var(--brand-dark); flex-shrink: 0; }

  .field-input-wrap { position: relative; }

  .field-input {
    width: 100%;
    height: 50px;
    padding: 0 14px 0 44px;
    border: 1.5px solid var(--border);
    border-radius: var(--radius-md);
    background: var(--surface-2);
    font-family: 'Plus Jakarta Sans', sans-serif;
    font-size: 15px;
    font-weight: 600;
    color: var(--text-primary);
    outline: none;
    transition: border-color 0.18s ease, background 0.18s ease, box-shadow 0.18s ease;
    letter-spacing: 0.5px;
  }

  .field-input::placeholder { color: var(--text-muted); font-weight: 400; font-size: 14px; letter-spacing: 0; }

  .field-input:focus {
    border-color: var(--brand);
    background: var(--surface);
    box-shadow: 0 0 0 3px var(--brand-glow);
  }

  .field-input.error {
    border-color: var(--danger);
    box-shadow: 0 0 0 3px rgba(255, 92, 92, 0.15);
  }

  .input-icon {
    position: absolute;
    left: 14px;
    top: 50%;
    transform: translateY(-50%);
    pointer-events: none;
  }

  .input-icon svg { width: 18px; height: 18px; stroke: var(--text-muted); }

  .field-hint {
    font-size: 11px;
    font-weight: 500;
    color: var(--text-muted);
    margin-top: 7px;
    line-height: 1.4;
  }

  .field-error {
    font-size: 12px;
    font-weight: 600;
    color: var(--danger);
    margin-top: 6px;
    display: flex;
    align-items: center;
    gap: 4px;
  }

  .field-error svg { width: 13px; height: 13px; stroke: currentColor; flex-shrink: 0; }

  /* ── CTA button ── */
  .cta-wrap { padding: 14px 16px 0; }

  .btn-primary {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    width: 100%;
    height: 52px;
    background: var(--brand);
    color: #fff;
    border: none;
    border-radius: var(--radius-lg);
    font-family: 'Plus Jakarta Sans', sans-serif;
    font-size: 15px;
    font-weight: 700;
    letter-spacing: -0.2px;
    cursor: pointer;
    box-shadow: 0 4px 16px var(--brand-glow);
    transition: background 0.15s ease, box-shadow 0.15s ease;
    -webkit-tap-highlight-color: transparent;
  }

  .btn-primary:hover  { background: var(--brand-dark); box-shadow: 0 6px 20px rgba(0,200,150,0.32); }
  .btn-primary:active { background: var(--brand-dark); box-shadow: none; }
  .btn-primary svg    { width: 18px; height: 18px; stroke: #fff; }

  /* ── Safety tip card ── */
  .tip-card {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: var(--radius-xl);
    margin: 12px 16px 0;
    padding: 16px 18px;
    display: flex;
    align-items: flex-start;
    gap: 12px;
    box-shadow: var(--shadow-sm);
  }

  .tip-icon {
    width: 36px;
    height: 36px;
    background: #FFF0F0;
    border-radius: 10px;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
  }

  .tip-icon svg { width: 17px; height: 17px; stroke: var(--danger); }

  .tip-title { font-size: 13px; font-weight: 700; color: var(--text-primary); margin-bottom: 3px; }
  .tip-desc  { font-size: 12px; font-weight: 500; color: var(--text-muted); line-height: 1.5; }
</style>

<div class="app-shell">

  <!-- Top bar -->
  <div class="app-topbar">
    <div class="topbar-icon">
      <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"/>
      </svg>
    </div>
    <div>
      <div class="topbar-title">Emergency Contact</div>
      <div class="topbar-sub">Add a trusted number for emergencies</div>
    </div>
  </div>

  <!-- Success message -->
  {% if success_message %}
    <div class="success-wrap">
      <div class="msg-toast">
        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
        </svg>
        {{ success_message }}
      </div>
    </div>
  {% endif %}

  <!-- SOS hero card -->
  <div class="sos-hero">
    <div class="sos-circle">
      <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/>
      </svg>
    </div>
    <div class="sos-title">Your emergency lifeline</div>
    <div class="sos-desc">This number will be alerted instantly if you trigger an SOS during a ride.</div>
  </div>

  <!-- Section header -->
  <div class="section-header">
    <div class="section-dot"></div>
    <div class="section-title">Contact Number</div>
  </div>

  <!-- Form -->
  <form method="POST">
    {% csrf_token %}

    <div class="form-card">
      <div class="field-label">
        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"/>
        </svg>
        Mobile Number
      </div>

      <div class="field-input-wrap">
        <div class="input-icon">
          <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"/>
          </svg>
        </div>
        <input
          type="text"
          id="emergency_contact"
          name="emergency_contact"
          value="{{ form.emergency_contact.value|default_if_none:'' }}"
          placeholder="Enter 10-digit mobile number"
          class="field-input"
          pattern="\d{10}"
          maxlength="10"
          inputmode="numeric"
          title="Please enter exactly 10 digits"
          required
        >
      </div>

      <p id="contact-error" class="field-error hidden">
        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01"/>
        </svg>
        Please enter a valid 10-digit number
      </p>
      <p class="field-hint">This number will be contacted in case of an emergency</p>
    </div>

    <!-- Save button -->
    <div class="cta-wrap">
      <button type="submit" class="btn-primary">
        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
        </svg>
        Save Contact
      </button>
    </div>
  </form>

  <!-- Safety tip -->
  <div class="tip-card">
    <div class="tip-icon">
      <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
      </svg>
    </div>
    <div>
      <div class="tip-title">Safety Tip</div>
      <div class="tip-desc">Make sure this number is always active and belongs to someone who can help you in emergencies.</div>
    </div>
  </div>

</div><!-- /app-shell -->

<script>
  const contactInput = document.getElementById('emergency_contact');
  const errorMsg     = document.getElementById('contact-error');

  contactInput.addEventListener('input', () => {
    const value = contactInput.value.trim();
    if (/^\d{10}$/.test(value)) {
      errorMsg.classList.add('hidden');
      contactInput.classList.remove('error');
    } else {
      errorMsg.classList.remove('hidden');
      contactInput.classList.add('error');
    }
  });
</script>